---
title: "Implicancia de Tenacibaculosis en la mortalidad en Salmón del Atlántico"
author: "Constanza Pino Ajenjo"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(readxl)
library(tidyverse)
library(kableExtra)
library(pander)
library(DT)
```

Descripción del problema a resolver: 
La Tenacibaculosis es una infección bacteriana cuya etiología Tenacibaculum maritimus (Flexibacter maritimus) afecta principalmente al cultivo de Salmón del Atlántico. Principalmente se evidencian lesiones macroscópicas en la superficie del cuerpo; úlceras, necrosis, boca erosionada, aletas deshilachadas y cola con pudrición,
y a veces necrosis en las branquias y los ojos (congestión choroidal y hemorragia sub-choroidal, a veces con ruptura del ojo). Por tal motivo, es importante determinar la implicancia de la mortalidad causada por Tenacibaculosis en agua de mar.

Variables de estudio: número de ingreso de peces (Ingreso), peso promedio de los peces en gramos (Peso_g), número de mortalidad total de peces (Mortalidad) y número de mortalidad de peces causada por Tenacibaculosis (Mort_Tena). 

Factor a analizar: Centros en agua de mar (Centro) y Alimento (Alimento).

Número total de observaciones: 24

```{r Preparar datos,echo=TRUE}
#Cargar la base de datos en el objeto Tena:
Tena <- read_excel("Tenacibaculosis.xlsx", sheet=1,na="NA")
head(Tena)

#Ordenar Tena creando un objeto tidy_Tena con las variables de interés:
tidy_Tena <- select(Tena,Centro,Alimento,Ingreso,Peso_g,Mortalidad, Mort_Tena)
head(tidy_Tena)

#Explorar si las variables son números o carácteres:
str(tidy_Tena)

#Transformar Centro a factor usando as.factor y visualizar que Centro esté transformado adecuadamente a factor y los datos están balanceados:
tidy_Tena$Centro <- as.factor(tidy_Tena$Centro)
tidy_Tena$Alimento <- as.factor(tidy_Tena$Alimento)
summary(tidy_Tena)
table(tidy_Tena$Centro,tidy_Tena$Alimento)

#Generar una tabla con la base de datos de tidy_Tena con función datatable:
DT::datatable(tidy_Tena,caption="Tabla 1. Número de ingreso, peso promedio y número de mortalidad por Centro")

#Resumen de estadística descriptiva con función pander:
pander(summary(tidy_Tena,caption="Resumen data frame"))

#Observar el comportamiento de las variables en estudio usando histogramas y boxplot:
#1. Variable Alimento:
par(mfrow=c(1, 2))
boxplot(tidy_Tena$Alimento,main="Boxplot de tipo de Alimento",ylab="Alimento",col = "white")
#2. Variable Ingreso:
hist(tidy_Tena$Ingreso,main="Histograma de número de Ingreso",xlab="Ingreso",col="blue")
boxplot(tidy_Tena$Ingreso,main="Boxplot de número de Ingreso",ylab="Ingreso",col = "blue")
#3. Variable Peso:
hist(tidy_Tena$Peso_g,main="Histograma de Peso promedio (g)",xlab="Peso_g",col="red")
boxplot(tidy_Tena$Peso_g,main="Boxplot de Peso promedio (g)",ylab="Peso_g",col ="red")
#4. Variable Mortalidad:
hist(tidy_Tena$Mortalidad,main="Histograma de número de Mortalidad total",xlab="Mortalidad",col="orange")
boxplot(tidy_Tena$Mortalidad,main="Boxplot de número de Mortalidad total",ylab="Mortalidad",col ="orange")
#5. Variable Mort_Tena:
hist(tidy_Tena$Mort_Tena,main="Histograma de número de Mortalidad por Tenacibaculosis",xlab="Mortalidad Tenacibaculosis",col="green")
boxplot(tidy_Tena$Mort_Tena,main="Boxplot de número de Mortalidad por Tenacibaculosis",ylab="Mort_Tena",col ="green")

#Establecer relación entre variables cuantitativas y factores usando gráficas de correlación, boxplot, interacción o de tamaño de los efectos:

ggplot(data=tidy_Tena, mapping=aes(x="Centro",y="Mort_Tena"))+geom_boxplot()


```



```{r Gráficos Ingreso, echo=TRUE}

hist_ing <- ggplot(tidy_Tena,aes(Ingreso))+
  geom_histogram(bins=9)
hist_ing

```

```{r Gráficos Peso promedio ,echo=TRUE}

hist_peso <- ggplot(tidy_Tena,aes(Peso_g))+
  geom_histogram(bins=12)
hist_peso

```
```{r Gráficos Mortalidad total,echo=TRUE}
hist_mort <- ggplot(tidy_Tena,aes(Mortalidad))+
  geom_histogram(bins=12)
hist_mort

```
```{r Gráficos Mortalidad Tenacibaculosis,echo=TRUE}
hist_Tena <- ggplot(tidy_Tena,aes(Mort_Tena))+
  geom_histogram(bins=10)
hist_Tena
```

