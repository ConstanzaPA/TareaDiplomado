---
title: "Implicancia de Tenacibaculosis en la mortalidad en Salmón del Atlántico"
author: "Constanza Pino Ajenjo"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(readxl)
library(tidyverse)
library(kableExtra)
library(pander)
library(DT)
```

**Descripción del problema a resolver:** 
La Tenacibaculosis es una infección bacteriana cuya etiología Tenacibaculum maritimus (Flexibacter maritimus) afecta principalmente al cultivo de Salmón del Atlántico. Principalmente se evidencian lesiones macroscópicas en la superficie del cuerpo; úlceras, necrosis, boca erosionada, aletas deshilachadas y cola con pudrición, y a veces necrosis en las branquias y los ojos (congestión choroidal y hemorragia sub-choroidal, a veces con ruptura del ojo). Por tal motivo, es importante determinar la implicancia de la mortalidad causada por Tenacibaculosis en agua de mar.

**Variables de estudio:** peso promedio de los peces en gramos (Peso_g), número de mortalidad total de peces (Mortalidad) y número de mortalidad de peces causada por Tenacibaculosis (Mort_Tena). 

**Factor a analizar:** Centros en agua de mar (Centro) y tipo de alimento (Alimento).

**Número total de observaciones:** 24


```{r Preparar datos,echo=TRUE}
#Cargar la base de datos en el objeto Tena:
Tena <- read_excel("Tenacibaculosis.xlsx", sheet=1,na="NA")
head(Tena)

#Ordenar Tena creando un objeto tidy_Tena con las variables de interés:
tidy_Tena <- select(Tena,Centro,Alimento,Ingreso,Peso_g,Mortalidad,Mort_Tena)
head(tidy_Tena)

#Explorar si las variables son números o carácteres:
str(tidy_Tena)

#Transformar Centro y Alimento a factor usando as.factor, luego visualizar que Centro y Alimento estén transformados adecuadamente a factor y que los datos están balanceados:
tidy_Tena$Centro <- as.factor(tidy_Tena$Centro)
tidy_Tena$Alimento <- as.factor(tidy_Tena$Alimento)
summary(tidy_Tena)
table(tidy_Tena$Centro,tidy_Tena$Alimento)

#Generar una tabla con la base de datos de tidy_Tena con función datatable:
DT::datatable(tidy_Tena,caption="Tabla 1. Número de ingreso, peso promedio y número de mortalidad por Centro")

#Resumen de estadística descriptiva con función pander:
pander(summary(tidy_Tena,caption="Resumen data frame"))

```



```{r Histograma y boxplot Ingreso, echo=TRUE}
#Observar el comportamiento de las variables en estudio usando histogramas y boxplot (valor atípico se muestra en punto de color rojo):

hist_ing <- ggplot(tidy_Tena,aes(Ingreso))+
  geom_histogram(fill="blue",bins=10)+
  labs(title = "Figura 1. Histograma de número de ingreso de peces")
hist_ing
blot_ing <- ggplot(tidy_Tena,aes(y=Ingreso,x=Alimento))+
  geom_boxplot(fill="blue",outlier.colour = "red")+
  labs(title="Figura 2. Boxplot de número ingreso peces por tipo de alimento",y="Número de ingreso",x="Tipo de Alimento")
blot_ing
```

```{r Histograma y boxplot Peso promedio ,echo=TRUE}

hist_peso <- ggplot(tidy_Tena,aes(Peso_g))+
  geom_histogram(fill="red",bins=12)+
  labs(title = "Figura 3. Histograma de peso promedio de los peces")
hist_peso
blot_peso <- ggplot(tidy_Tena,aes(y=Peso_g,x=Alimento))+
  geom_boxplot(fill="red",outlier.colour = "red")+
  labs(title="Figura 4. Boxplot de peso promedio por tipo de alimento",y="Peso promedio (g)",x="Tipo de Alimento")
blot_peso
```
```{r Histograma y boxplot Mortalidad total,echo=TRUE}

hist_mort <- ggplot(tidy_Tena,aes(Mortalidad))+
  geom_histogram(fill="orange",bins=12)+
  labs(title = "Figura 5. Histograma de número de mortalidad total")
hist_mort
blot_mort <- ggplot(tidy_Tena,aes(y=Mortalidad,x=Alimento))+
  geom_boxplot(fill="orange",outlier.colour = "red")+
  labs(title="Figura 6. Boxplot de mortalidad total por tipo de alimento",y="Número de mortalidad total",x="Tipo de Alimento")
blot_mort
```
```{r Histograma y boxplot Mortalidad Tenacibaculosis,echo=TRUE}

hist_Tena <- ggplot(tidy_Tena,aes(Mort_Tena))+
  geom_histogram(fill="green",bins=10)+
  labs(title = "Figura 7. Histograma de número de mortalidad por Tenacibaculosis")
hist_Tena
blot_Tena <- ggplot(tidy_Tena,aes(y=Mort_Tena,x=Alimento))+
  geom_boxplot(fill="green",outlier.colour = "red")+
  labs(title="Figura 8. Boxplot mortalidad Tenacibaculosis por tipo de alimento",y="Número mortalidad por Tenacibaculosis",x="Tipo de Alimento")
blot_Tena
```

```{r Gráficos interacción 1,echo=TRUE}
interaction.plot(tidy_Tena$Centro,tidy_Tena$Alimento, tidy_Tena$Peso_g,trace.label="Alimento",fun=mean,main="Figura 9. Interacción entre peso promedio y factores", xlab="Centro",ylab="Peso promedio (g)",type="b", col= c("black", "red"),pch=c(19,17))
 
plot.design(tidy_Tena$Peso_g~tidy_Tena$Centro*tidy_Tena$Alimento,main="Figura 10. Gráfico de interacción",xlab="Factores", ylab="Peso promedio (g)")
```



```{r Gráficos interacción 2,echo=TRUE}
#Establecer relación entre variables cuantitativas y factores usando gráficas de correlación, boxplot, interacción o de tamaño de los efectos:

interaction.plot(tidy_Tena$Centro,tidy_Tena$Alimento, tidy_Tena$Mortalidad,trace.label="Alimento",fun=mean,main="Figura 11. Interacción entre mortalidad total y factores", xlab="Centro",ylab="Mortalidad",type="b", col= c("black", "red"),pch=c(19,17))
 
plot.design(tidy_Tena$Mortalidad~tidy_Tena$Centro*tidy_Tena$Alimento,main="Figura 12. Gráfico de interacción",xlab="Factores", ylab="Mortalidad")
```




```{r Gráficos interacción 3,echo=TRUE}
interaction.plot(tidy_Tena$Centro,tidy_Tena$Alimento, tidy_Tena$Mort_Tena,trace.label="Alimento",fun=mean,main="Figura 13. Interacción entre mortalidad Tenacibaculosis y factores", xlab="Centro",ylab="Mortalidad Tenacibaculosis",type="b", col= c("black", "red"),pch=c(19,17))
 
plot.design(tidy_Tena$Mort_Tena~tidy_Tena$Centro*tidy_Tena$Alimento,main="Figura 14. Gráfico de interacción de factores",xlab="Factores", ylab="Mortalidad Tenacibaculosis")
```



