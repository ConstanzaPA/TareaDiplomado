---
title: "Implicancia de Tenacibaculosis en la mortalidad en Salmón del Atlántico"
author: "Constanza Pino Ajenjo"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(readxl)
library(tidyverse)
library(kableExtra)
library(pander)
library(DT)
```

Descripción del problema a resolver: 
La Tenacibaculosis es una infección bacteriana cuya etiología Tenacibaculum maritimus (Flexibacter maritimus) afecta principalmente al cultivo de Salmón del Atlántico. Principalmente se evidencian lesiones macroscópicas en la superficie del cuerpo; úlceras, necrosis, boca erosionada, aletas deshilachadas y cola con pudrición,
y a veces necrosis en las branquias y los ojos (congestión choroidal y hemorragia sub-choroidal, a veces con ruptura del ojo). Por tal motivo, es importante determinar la implicancia de la mortalidad causada por Tenacibaculosis en agua de mar.

Variables de estudio: número de ingreso de peces (Ingreso), peso promedio de los peces en gramos (Peso_g), número de mortalidad total de peces (Mortalidad) y número de mortalidad de peces causada por Tenacibaculosis (Mort_Tena). 

Factor a analizar: Centros en agua de mar (Centro) y Alimento (Alimento).

Número total de observaciones: 24

```{r Preparar datos,echo=TRUE}
#Cargar la base de datos en el objeto Tena:
Tena <- read_excel("Tenacibaculosis.xlsx", sheet=1,na="NA")
head(Tena)

#Ordenar Tena creando un objeto tidy_Tena con las variables de interés:
tidy_Tena <- select(Tena,Centro,Alimento,Ingreso,Peso_g,Mortalidad, Mort_Tena)
head(tidy_Tena)

#Explorar si las variables son números o carácteres:
str(tidy_Tena)

#Transformar Centro a factor usando as.factor y visualizar que Centro esté transformado adecuadamente a factor y los datos están balanceados:
tidy_Tena$Centro <- as.factor(tidy_Tena$Centro)
tidy_Tena$Alimento <- as.factor(tidy_Tena$Alimento)
summary(tidy_Tena)
table(tidy_Tena$Centro,tidy_Tena$Alimento)

#Generar una tabla con la base de datos de tidy_Tena con función datatable:
DT::datatable(tidy_Tena,caption="Tabla 1. Número de ingreso, peso promedio y número de mortalidad por Centro")

#Resumen de estadística descriptiva con función pander:
pander(summary(tidy_Tena,caption="Resumen data frame"))

```



```{r Gráficos Ingreso, echo=TRUE}
#Observar el comportamiento de las variables en estudio usando histogramas y boxplot:

par(mfrow=c(1, 2))
hist_ing <- ggplot(tidy_Tena,aes(Ingreso))+
  geom_histogram(fill="blue",bins=10)+
  labs(title = "Figura 1. Histograma de número de Ingreso de peces")
hist_ing
blot_ing <- ggplot(tidy_Tena,aes(y=Ingreso,x=Alimento))+
  geom_boxplot(fill="blue",outlier.colour = "red")+
  labs(title="Figura 2. Boxplot de número ingreso peces por tipo de alimento",y="Ingreso",x="Tipo de Alimento")
blot_ing

```

```{r Gráficos Peso promedio ,echo=TRUE}
par(mfrow=c(1, 2))
hist_peso <- ggplot(tidy_Tena,aes(Peso_g))+
  geom_histogram(fill="red",bins=12)+
  labs(title = "Figura 3. Histograma de peso promedio de los peces")
hist_peso
blot_peso <- ggplot(tidy_Tena,aes(y=Peso_g,x=Alimento))+
  geom_boxplot(fill="red",outlier.colour = "red")+
  labs(title="Figura 4. Boxplot de peso promedio por tipo de alimento",y="Peso promedio (g)",x="Tipo de Alimento")
blot_peso
```
```{r Gráficos Mortalidad total,echo=TRUE}
par(mfrow=c(1, 2))
hist_mort <- ggplot(tidy_Tena,aes(Mortalidad))+
  geom_histogram(fill="orange",bins=12)+
  labs(title = "Figura 5. Histograma de número de mortalidad total")
hist_mort
blot_mort <- ggplot(tidy_Tena,aes(y=Mortalidad,x=Alimento))+
  geom_boxplot(fill="orange",outlier.colour = "red")+
  labs(title="Figura 6. Boxplot de mortalidad total por tipo de alimento",y="Mortalidad total",x="Tipo de Alimento")
blot_mort
```
```{r Gráficos Mortalidad Tenacibaculosis,echo=TRUE}
par(mfrow=c(1, 2))
hist_Tena <- ggplot(tidy_Tena,aes(Mort_Tena))+
  geom_histogram(fill="green",bins=10)+
  labs(title = "Figura 7. Histograma de número de Mortalidad por Tenacibaculosis")
hist_Tena
blot_Tena <- ggplot(tidy_Tena,aes(y=Mort_Tena,x=Alimento))+
  geom_boxplot(fill="green",outlier.colour = "red")+
  labs(title="Figura 8. Boxplot de mortalidad por Tenacibaculosis según tipo de alimento",y="Mortalidad por Tenacibaculosis",x="Tipo de Alimento")
blot_Tena
```

```{r Gráficos interacción,echo=TRUE}
#Establecer relación entre variables cuantitativas y factores usando gráficas de correlación, boxplot, interacción o de tamaño de los efectos:

ggplot(data=tidy_Tena, mapping=aes(x="Centro",y="Mort_Tena"))+geom_boxplot()
```

