---
title: "Implicancia de Tenacibaculosis en la mortalidad de Salmón del Atlántico"
author: "Constanza Pino Ajenjo"
date: "`r Sys.Date()`"
output: 
  beamer_presentation:
    theme: Malmoe
    colortheme: seahorse
    fonttheme: professionalfonts
    includes:
      in_header: mystyle.tex
    ioslides_presentation: default
    slidy_presentation: default
    powerpoint_presentation: default
subtitle: Diplomado en Análisis de datos con R para la Acuicultura
institute: Pontificia Universidad Católica de Valparaíso
---

```{r setup, include=FALSE, comment=TRUE}
knitr::opts_chunk$set(echo = FALSE)

library(knitr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyselect)
library(readxl)
library(tidyverse)
library(kableExtra)
library(pander)
library(DT)
library(gridExtra)
library(stats)
library(stats4)

```


## Introducción

**Descripción del problema a resolver:** 
Tenacibaculosis es una infección bacteriana cuya etiología Tenacibaculum maritimus (Flexibacter maritimus) afecta principalmente al cultivo de Salmón del Atlántico. Principalmente se evidencian lesiones macroscópicas en la superficie del cuerpo; úlceras, necrosis, boca erosionada, aletas deshilachadas y cola con pudrición, y a veces necrosis en las branquias y los ojos (congestión choroidal y hemorragia sub-choroidal, a veces con ruptura del ojo). Debido a su impacto en la salud de Salmón del Atlántico, es importante analizar si los actuales tipos de dieta tienen alguna implicancia en la mortalidad por Tenacibaculosis en los centros de cultivo en agua de mar.

## Introducción

**Variables de estudio:** 
En este trabajo se observan las variables obtenidas durante los últimos cinco años en cada centro de cultivo en agua de mar:

- número de mortalidad causada por Tenacibaculosis (Mort_Tena)


**Factores a analizar:** 

- tipos de alimentos (Alimento).

**Número total de observaciones:** 

- 236 jaulas de cultivo en agua de mar (Unidad).

**Hipótesis:**

- Hipótesis nula (H0): los tipos de alimentos son iguales en la mortalidad por Tenacibaculosis.

- Hipotesis alternativa (H1): los tipos de alimentos son distintos.


## Desarrollo

```{r Preparar datos, include=FALSE, comment=FALSE}
knitr::opts_chunk$set(echo = FALSE)

#Cargar la base de datos en el objeto Dietas:
Dieta <- read_excel("Dieta.xlsx", sheet=1,na="NA")
Dieta <- na.omit(Dieta)
head(Dieta)

#Explorar si las variables son números o carácteres:
str(Dieta)

#Transformar Unidad y Dieta a factor usando as.factor, luego visualizar que Unidad y Dieta estén transformados adecuadamente a factor y que los datos están balanceados:
Dieta$Unidad <- as.factor(Dieta$Unidad)
Dieta$Dieta <- as.factor(Dieta$Dieta)
summary(Dieta)

```



```{r Gráficos exploratorios, include=FALSE, comment=FALSE}

My_Theme = theme(axis.title.x = element_text(size = 18),
  axis.text.x = element_text(size = 18),
  axis.title.y = element_text(size = 18),
  axis.text.y = element_text(size = 18))

hist_Mort <- ggplot(Dieta,aes(Mortalidad))+
  geom_histogram(fill="lightblue",color="black",bins=10)

blot_Dieta <- ggplot(Dieta,aes(y=Mortalidad,x=Dieta))+
  geom_boxplot(fill="lightgreen",outlier.colour = "red")+
  labs(y="Mortalidad total",x="Tipo de Dieta")

theme_classic()

```

**Frecuencia de mortalidad total**
```{r Gráfico 1, warning=FALSE, message=FALSE, out.width = '70%', fig.align='center',fig.cap="Mortalidad total"}

hist_Mort+My_Theme

```

## Desarrollo

**Tipo de dieta vs mortalidad total**
```{r blot, warning=FALSE, message=FALSE, out.width = '70%', fig.align='center'}
knitr::opts_chunk$set(echo = FALSE)

blot_Dieta+My_Theme
```


## Desarrollo
```{r, Tabla media y varianza, warning=FALSE, message=FALSE, out.width = '70%', fig.align='center'}

Tabla1 = Dieta %>% group_by(Dieta) %>%
summarize(N= n(), Mean = mean(Mortalidad),
          Variance= var(Mortalidad))

```


**Media y varianza de mortalidad total por tipo de dieta**

```{r, Tabla 1, echo=TRUE, out.width = '70%', fig.align='center'}

knitr::kable(Tabla1)
```

## Desarrollo

```{r Modelo lineal genral nulo, message=FALSE, out.width = '70%', fig.align='center'}

chisq.test(Dieta, correct = FALSE)


```

## Desarrollo

```{r Modelo lineal general 1, message=FALSE, out.width = '70%', fig.align='center'}



```

## Desarrollo

```{r Comparación modelos lineales generales, message=FALSE, out.width = '70%', fig.align='center'}



```


## Conclusión

```{r}

```

